---
title: Getting Data In and Out of Gatsby
options:
  published: false
  customurl: ''
  customtemplate: ''
meta:
  date: 2020-04-26T20:50:22.346Z
  excerpt: Using RSS and Webhooks to syndicate posts from one Gatsby site to another.
  categories:
    - code
  tags:
    - gatsby
    - rss
---
A while back, my friend [Josh](https://twitter.com/Kaytal1) wanted to start a development blog with me. He even went through all the trouble buying a url and setting us each our own subdomain. Since I already had my own blog, primarily about development, writing another one seemed like a lot of work.

<img src="/images/uploads/bender_two_things.gif" alt="Bender talking to Fry and The Professor" data-caption="" data-align="center" data-small="true" />

But, since I *did* already have a blog, it definitely seemed possible to syndicate my posts from one site to the other. I put together a [quick site](https://github.com/ryanfiller/bearded-robots) with [Material-UI](https://material-ui.com/) and started trying to figure out how to get data out of one Gatsby site and into the other.

## Gatsby has GraphQL, right?

Yes, it does - and trying to directly query that endpoint was my first thought. `localhost:8000/__graphiql `is a thing, so `ryanfiller.com/__graphiql` probably is too, right?

Well, no. Gatsby has a long section of [their docs](https://www.gatsbyjs.org/docs/graphql/) about Graphql, but the short version of it is that Gatsby is a static site generator, not a serverside application. This means that while running locally, or during build time, a queryable graph exists and is used to gather data and generate pages. Once the production site is built from that data, that graph goes away and the generated site is sent to production, and therefore there is no live GraphQL endpoint on a deployed Gatsby site.

## Getting Data Out

Since accessing GraphQL directly, the next step is to set up a custom API endpoint and have one site make a [`fetch`](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API) call to the other. 

### Two Competing Data Types

For scenarios like this there are two obvious ways to format the endpoint - [JSON](https://en.wikipedia.org/wiki/JSON) and [RSS](https://en.wikipedia.org/wiki/RSS). There are pros and cons to both approaches (and I even went down a route [on my old site](https://2018.ryanfiller.com/syndicate.json) using the [JSON Feed](https://jsonfeed.org/) standard), but it seems like RSS is still the most common type for syndicating data to sites such as dev.to or Medium. JSON seems to be the standard for posting and grabbing complex data, and RSS for content. I ended up settling with and RSS endpoint, but the same principles should apply to either scenario in mostly the same way.

### Getting Gatsby to Format Data

The easiest way to do most things in Gatsby is to look for a plugin, and luckily for RSS feeds there's a [first party one](https://www.gatsbyjs.org/packages/gatsby-plugin-feed/). To look into how this plug in works, the magic happens in its `src/gatsby-node.js` file. The plugin either uses its default searialize function or takes one from its configuration object, and uses this function to query the appropriate posts, map through them, and format them into a new shape for the feed. For blogs with a LOT of content, this can be a slow process. Luckily, I came across this [Kent C. Dodds Twitter thread](https://twitter.com/kentcdodds/status/1230333532288901121) outlining how this problem could be fixed. The three biggest takeaways:

* Limit the number of posts, RSS feeds will check for updates often and heavily cache old posts
* Don't rely on complex image transformations (like `gatsby-transformer-sharp)`
* Content doesn't need to be posted full in its original form, it can be transformed in the `serialize` function.

Since I'm not using Gatsby's image processing, the only thing I really needed to worry about was making sure that my images would point to the correct url instead of trying to look for the relative path at whichever new site I was sharing posts to. I also wasn't too concerned with limiting the number of post sicne I'm fine with a "Read More on My Full Site" button at the bottom of my second Gatsby site.



getting data in

\- using a plugin

\- transforming data

notifying one site to build